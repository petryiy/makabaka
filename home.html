<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Home</title>
        <link rel="icon" href="images/favicon.png" type="image/png">
        <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
        <link rel="stylesheet" href="css/home.css">
    </head>
    <nav class="navbar">
        <div class="nav-left">💚 LUV U</div>
        <ul class="nav-right">
            <li><a href="home.html">Home</a></li>
            <li><a href="album.html">📷 Album</a></li>
            <li><a href="theatre.html?mode=all">🕰️ Timeline</a></li>
            <li><a href="future.html">🌟Wish</a></li>
            <li><a href="about.html">💬 About</a></li>
            <li><a href="devlog.html">🧑‍💻 DevLog</a></li>
        </ul>
    </nav>

    <main class="main-section">
        <div id="music-control" style="position: fixed; top: 90%; right: 30px; z-index: 100;">
            <button id="toggle-music" style="background: transparent; border: none; color: white; font-size: 2rem; cursor: pointer;">
              🎵
            </button>
        </div>
          
        <div id="yt-music-player" style="display: none;"></div>
        <h2 class="together-title">我们已经在一起</h2>
        <div class="timer">
            <div><span id="days" class="red"></span><div>Days</div></div>
            <div><span id="hours" class="orange"></span><div>Hours</div></div>
            <div><span id="minutes" class="yellow"></span><div>Minutes</div></div>
            <div><span id="seconds" class="green"></span><div>Seconds</div></div>
        </div>
    </main>

    <section class="link-boxes">
        <a href="album.html" class="link-box">
            📷 <h3>Album</h3><p>留住你我回忆</p>
        </a>
        <a href="theatre.html?mode=all" class="link-box">
            🕰️ <h3>Time Machine</h3><p>记录你我生活</p>
        </a>
        <a href="future.html" class="link-box">
            🧡 <h3>Wish Bottle</h3><p>让我们憧憬未来</p>
        </a>
    </section>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 petryiy. All rights reserved.</p>
            <p>Built with 🩷 to Adonia.</p>
            <div class="social-icons">
            <a href="https://www.instagram.com/michaelzhang715/" target="_blank" class="social-icon">
                <i class="fab fa-instagram"></i>
            </a>
            <a href="www.linkedin.com/in/ruiqi-zhang-michael" target="_blank" class="social-icon">
                <i class="fab fa-linkedin-in"></i>
            </a>
            <a href="https://github.com/petryiy" target="_blank" class="social-icon">
                <i class="fab fa-github"></i>
            </a>
            </div>
        </div>
    </footer>

    <script src="scripts/home.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
      let player;
      let isPlaying = false;
      let hasStartedMusic = false;
      
      const toggleBtn = document.getElementById("toggle-music");
  
      function initializeYouTubePlayer() {
        player = new YT.Player('yt-music-player', {
            videoId: 'KGbfyhKD6yw', // Do U
            playerVars: {
                autoplay: 1,
                loop: 1,
                controls: 0,
                playlist: 'KGbfyhKD6yw',
                modestbranding: 1,
                rel: 0
            },
            events: {
                onReady: (event) => {
              
                if (!hasStartedMusic) {
                    event.target.playVideo();
                    event.target.unMute();
                    hasStartedMusic = true;
                }
                isPlaying = event.target.getPlayerState() === YT.PlayerState.PLAYING;
                updateButtonIcon();

                
                if (toggleBtn) { 
                    toggleBtn.addEventListener("click", (e) => {
                    e.stopPropagation();
                    if (isPlaying) {
                        player.pauseVideo();
                    } else {
                        player.playVideo();
                        player.unMute();
                        hasStartedMusic = true; 
                    }
                    });
                }
                },
                onStateChange: (event) => {
                    isPlaying = event.data === YT.PlayerState.PLAYING;
                    updateButtonIcon();
                }
            }
        });
      }
  
     
      function onYouTubeIframeAPIReady() {
        initializeYouTubePlayer();
      }
  
      if (window.YT && window.YT.Player) {
        onYouTubeIframeAPIReady();
      }
  
      const originalShowWish = window.showWish;
      window.showWish = function (index) {
        if (player && !hasStartedMusic) {
            player.playVideo();
            player.unMute();
            hasStartedMusic = true;
        }
        if (originalShowWish) {
            originalShowWish(index);
        }
      };
  
      function updateButtonIcon() {
        if (toggleBtn) { // 确保按钮元素存在
            toggleBtn.textContent = isPlaying ? "🎵" : "🔇";
        }
      }
  </script>
</html>